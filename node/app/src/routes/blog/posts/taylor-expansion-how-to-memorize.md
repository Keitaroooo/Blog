---
title: テイラー展開【流れと覚え方】
date: 2019-02-28T23:02+09:00
---

<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>

初めて習ったときチンプンカンプンだったので，これから習う人が分かりやすいようにまとめてみました．

厳密なところは分かっていないです．また，自分なりの解釈が多いかもです．

# 目的

テイラー展開とは，ある関数$f(x)$を多項式（べき級数）で表すことをいいます．

$e^x$や$\sin x,\cos x$は複雑な関数で$x$に値を代入したとき，どのような値になるかよく分かりません．

そんなときに便利なのがテイラー展開で，これによりおおよその値を知ることができます．

例えば$e^x$は$1+\frac{x}{1!}+\frac{x^2}{2!}+\ldots+\frac{x^n}{n!}+\ldots$という風に展開されます．
ここで$x=0.01$のとき，$e^{0.01}$はよく分かりませんが，展開された方で考えると，2 次以上の項は 0.01 の 2 乗よりも小さいので無視できるとして，おおよそ 1+0.01=1.01 となることが分かります．

この近似は数学の世界では許されませんが，工学の世界では結構使われています．また，物理学の世界でも許されているみたいです．

他にも有限差分法の中で，差分近似を求めるときにテイラー展開を使ったりします．

# 展開の形

まず，簡単な$x=0$まわりのテイラー展開，別名マクローリン展開を考えます．

多項式で表すことを考えているので，

$$f(x)=a_0+a_1x+a_2x^2+\ldots+a_nx^n+\ldots\tag{1}$$
と表されるとします．

これの係数の形を求めることが目標で，まず，(1)の両辺に$x=0$を代入すれば$f(0)=a_0$となります．

次に，(1)の両辺を項別微分すると


$$f'(x)=a_1x+2a_2x+\ldots+na_n^{n-1}+\ldots$$
これに$x=0$を代入すると$f'(0)=a_1$

さらに，これを繰り返していくと

$$f''(0)=2!a_2,f'''(0)=3!a_3,\ldots,f^{(n)}(0)=n!a_n$$
従って，
$$a_0=f(0),a_1=\frac{f'(0)}{1!},a_2=\frac{f''(0)}{2!},a_3=\frac{f'''(0)}{3!},\ldots,a_n=\frac{f^{(n)}(0)}{n!},\ldots$$
が得られます．

そして，(1)の右辺にこれらの係数を代入して$f(x)$は次のように展開されることが分かりました．

$$f(x)=f(0)+\frac{f'(0)}{1!}x+\frac{f''(0)}{2!}x^2+\ldots+\frac{f^{(n)}(0)}{n!}x^n+\ldots\tag{2}$$
<br>
次に，より一般的なテイラー展開を考えますが，やることはほとんど一緒で，最初の仮定の形が違うだけです．

テイラー展開では$f(x)$を次のように表現できると考えます．


$$f(x)=a_0+a_1(x-a)+a_2(x-a)^2+\ldots+a_n(x-a)^n+\ldots\tag{3}$$

さっきは$x=0$を代入していったんですが，ここでは$x=a$を代入していけば，先程と同様にして，上手く係数が求められます．

そうして，次のような形に展開されることが分かります．


$$f(x)=f(a)+\frac{f'(a)}{1!}(x-a)+\frac{f''(a)}{2!}(x-a)^2+\ldots+\frac{f^{(n)}(a)}{n!}(x-a)^n+\ldots\tag{4}$$

これが$x=a$まわりのテイラー展開です．

## 2変数関数の場合

ここで，ちょっと応用なんですが，2 変数関数の場合$f(x,y)$を考えてみます．これも 1 変数の場合と同じように考えられて，まず


$$f(x,y)=a_0+a_1(x-a)+b_1(y-b)+a_2(x-a)^2+b_2(y-b)^2+c_2(x-a)(y-b)+\ldots\tag{5}$$
と表現できると考えます．

そして$x$と$y$で偏微分し，$x=a,y=b$を代入すると次々に係数が求まっていき，次のように展開できることが分かります．


$$f(x,y)=f(a,b)+\frac{\partial{f}}{\partial{x}}|\_{x=a,y=b}(x-a)+\frac{\partial{f}}{\partial{y}}|\_{x=a,y=b}(y-b)+\frac{\partial^2{f}}{\partial{x}^2}|\_{x=a,y=b}(x-a)^2+\frac{\partial^2{f}}{\partial{y}^2}|\_{x=a,y=b}(y-b)^2+\frac{\partial^2{f}}{\partial{x}\partial{y}}|\_{x=a,y=b}(x-a)(y-b)+\ldots\tag{6}$$

# 覚え方

毎回毎回上のように考えるのもありですが，楽な解釈の仕方があり，僕はそれで覚えています．

工学では$x-a\ll1$のとき2次以上の項は無視することが多く，このとき(4)は次のようになり，この形さえ覚えていれば結構使えます．


$$f(x)=f(a)+f'(a)(x-a)\tag{7}$$

この式の解釈として，右辺第2項の$f'(a)$が$x=a$での$f(x)$の傾きで，$(x-a)$が$x$の変化量だから，$(f(x)$の変化量)$=(x=a$での$f(x)$の傾き)$\times(x$の変化量)というふうに考えることができます．

グラフをイメージしたら分かりやすいんですが，$f(a)$から$a$にかなり近いところの$x$における$f(x)$を線形近似（直線で近似）によって求めてる感じで，この解釈で1次までのテイラー展開はイメージしやすいと思います．

また2変数のときは(6)より


$$f(x,y)=f(a,b)+\frac{\partial{f}}{\partial{x}}|\_{x=a,y=b}(x-a)+\frac{\partial{f}}{\partial{y}}|\_{x=a,y=b}(y-b)\tag{8}$$
となります．これも言葉で表すと$f(x,y)$の全変化が，$y$を止めて，$x$を動かしたときの$f(x,y)$の変化と$x$を止めて，$y$を動かしたときの$f(x,y)$の変化の和になります．

これも直交座標系で絵を描いて考えれば分かりやすいですが，$f(x,y)$を$x,y$方向それぞれ線形近似して求めている感じです．

で，(8)を言葉通り分かりやすく変形すると以下のようになります．


$$\Delta{f(x,y)}=\frac{\partial{f}}{\partial{x}}|\_{x=a,y=b}\Delta{x}+\frac{\partial{f}}{\partial{y}}|\_{x=a,y=b}\Delta{y}\tag{9}$$
いま，$x,y$の変化量を非常に小さいと思っていたので，(9)は

$$df=\frac{\partial{f}}{\partial{x}}dx+\frac{\partial{f}}{\partial{y}}dy\tag{10}$$
となります．

これは全微分と同じ形になっています．これがどういうことなのかはよく分かりませんが，全微分の意味を直感的に理解していると，テイラー展開が出てきやすい．ということは言えると思います．

まとめると，一応理論的なことは把握しつつ，直感的に覚えるのが良いのかなって感じです．

後，自分で考えて，自分なりの解釈を見つけるのが大事です．それが間違えてても誰かが教えてくれるはずです...
